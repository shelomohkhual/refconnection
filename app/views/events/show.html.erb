
<div class='row main-col'>
<div class='container col-md-7'>    
        <% if @event %>

    <div class='card'>

        <% if @event.organization == current_organization %>
            <div class="dropdown text-right">
            <a class="fas fa-ellipsis-h g-color" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            </a>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
            <%= link_to :"Edit", edit_event_path(@event),class:'dropdown-item' %>
            <%= link_to 'Delete', @event, method: :delete, data: { confirm: "remove this event?" }, class:"dropdown-item danger"%>
            </div>
            </div>
        <% end %>
    <h2><strong><%=@event.title%></strong></h2>
    <div class="show-info">
        <% unless @event.start_date == @event.end_date %>
            <h5> Date : <%= @event.start_date%> to <%= @event.end_date%> <h5>
        <% else %>
            <h5> Date :  <%= @event.start_date%> <h5>
        <% end %>
      </div>
    <div class="container row">
        <div><p>Organized By: <strong class='main-color'> <%= link_to @event.organization.company_name, organization_path(@event.organization)%></strong></p></div>
        <div class='time'><span class="g-color">â€¢ <%= time_ago_in_words(@event.updated_at)%> ago</span></div>
    </div>

      
        <% unless @event.images.empty? %>
            <div class="home-slide">
                <div id="carouselExampleCaptions" class="carousel slide smaller-carousel" data-ride="carousel">
                    <ol class="carousel-indicators">
                        <% (@event.images.length).times do |i| %>
                        <li data-target="#carouselExampleCaptions" data-slide-to="i" class= "<%="active" if i == 0%>"></li>
                        <% end %>
                    </ol>
                    <div class="carousel-inner">
                        <% (@event.images.length).times do |i| %>
                            <div class="carousel-item
                                <%="active" if i == 0%>
                            ">
              
                                <%= image_tag(url_for(@event.images[i]),class:'carousel-img')%>
                        
                            </div>
                        <% end%>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleCaptions" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleCaptions" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>
        <% end %>
        <hr>
        <%# CONTENT %>
        <div class='show-content'><p class='card-text'><%=@event.description%></p></div>
        <% if current_user  %>
          <strong><%= button_to 'ATTEND',{:controller => "events", :action => "attend", :user_id => current_user.id , :event_id => @event.id } ,class:'attend-btn' , :method=>:post%></strong>
        <%# <div class=''><button type="button" class="attend-btn"><strong>ATTEND</strong></button></div> %>
        <% end %>
    </div>  

    <%# COMMENT %>
    <div class="">
      <div class="card">
        <h3 class="">Comments</h3>
        <%# ADD NEW COMMENT %>
        <div class="container">
          <hr>
          <% if current_user %>
            <div>
            <%# ADD NEW COMMENT %>
                <%= simple_form_for @comment, remote: true, :url => "/comments", :method => :post do |f| %>
                <%= f.error_notification %>
                <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>
                <h4> Add New Comment </h4>
                <div class="form-inputs">
                <%= f.input :text, required: true %>
                <%=f.hidden_field :event_id, :value => "#{@event.id}"%>
                </div>
                <div class="form-actions text-center">
                <%= f.button :submit %>
                </div>
                <% end %>
            </div>
            <hr>
          <% end %>
            
            <div class='container'>
                <% if @comments.empty?%>
                  <p> There are no comments yet.</p>
                  <%else%>
                    <%(@comments.length).times do |i|%>
                      <% if @comments[i].organization == current_organization %>
                        <div class="dropdown text-right">
                          <a class="fas fa-ellipsis-h g-color" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          </a>
                          <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                          <%= link_to :"Edit", edit_comment_path(@comments[i]),class:'dropdown-item' %>
                          <%= link_to 'Delete', @comments[i], method: :delete, data: { confirm: "remove comment?" }, class:"dropdown-item danger"%>
                          </div>
                        </div>
                      <% end %>
                      <h4 class=""><%= @comments[i].text%></h4>
                      <h6 class='g-color'>     By : <%= @comments[i].organization.company_name %></h6>
                      <small class="text-dark">Commented :  <%= time_ago_in_words(@comments[i].created_at) %></small>
                      <hr>
                      <% end %>
                <% end %>
          </div>
        </div>
      </div>
    </div>
  <% else %>
            <p> There's no such event.</p>
        <% end %>
</div>
</div>
